# USBメモリで ZFS ！

## ZFSの習得にはUSBメモリが最適

時々ZFSを勉強するにはどうすればいいの？と聞かれることがあるのですが、筆者のおすすめはUSBメモリで試すことです。

ZFSによるRAID構成を実験する場合複数のストレージデバイスを用意する必要がありますが、SSDやHDDでRAID構成を試せる台数をそろえるのは大変です。USBメモリであればUSBハブと組み合わせることで複数のデバイスを試せて価格とスペースの点で有利で、さらに稼働中にいきなり抜く等の乱暴な試験も実現でき、ZFSでのRAID構成を習得するにはある意味うってつけと言えます。特にLED付きのUSBメモリであればアクセスの様子も目視で確認できるので見ていても楽しいです。🙂

なおZFSの習得にUSBメモリを使うという元ネタは、過去にサン・マイクロシステムズの「やっぱり Sun がスキ！」というSolarisの機能などを紹介するブログで、本記事と同じく「USBメモリで ZFS ！」のタイトルで投稿されたものです[^yappari]。

ここでは4個のUSBメモリを組み合わせて、ZFSによる様々なRAIDを構成してみます。

[^yappari]:2007年5月に投稿されたものでサイトはすでに閉鎖されていますが、当時の記事は[インターネットアーカイブで確認](https://web.archive.org/web/20071013152120/http://blogs.sun.com/yappri/entry/usb_zfs)できます。この記事を見て数年後に実際に自分で試したときは、なぜかUSB HDDが複数あったため、USBメモリでは無く[USB HDDで実験](https://www.facebook.com/photo?fbid=685848231475753&set=a.148549968538918)しました。

## 用意したもの

100円ショップでお馴染みのSeriaを見ていたらモデルチェンジしてUSBのメモリカードリーダが販売されていました。1個買って試してみたところ便利なことにアクセスLED付きでした。そこでこのメモリカードを4個買いそろえました。手元でSDカードやMicorSDカードが複数余っていたので、これらを組み合わせてUSBメモリとして実験します。

USBメモリが4個あれば多くのパターンのRAID構成がテストできます。

ZFSではデバイスを組み合わせてプールを作り、プール内にデータセット(ファイルシステムやボリューム等)を作って利用します。プールの操作にはzpoolコマンドを使い、ミラーやRAID5, RAID6等を作ります。用意したプールにzfsコマンドでデータセットを作ればファイルシステムとしてデータの読み書きができるようになるわけです。

ストレージデバイスが1台あればプールを作成できるので、zfsコマンドによる操作は自由にできるようになります。しかしプールの構成の違いなどを学ぶには複数のデバイスが必要になるので少し敷居が高くなります。そこでお勧めするのが、USBメモリを使う方法です。

USBメモリとUSBハブを用意すれば、
